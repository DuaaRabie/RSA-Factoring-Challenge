#!/usr/bin/python3
import sys
from math import sqrt
from math import gcd

def rho_fun(n):
    if n % 2 == 0:
        return 2
    x = 2; y = 2; d = 1
    f = lambda x: (x**2 + 1) % n
    while d == 1:
        x = f(x)
        y = f(f(y))
        d = gcd(abs(x-y), n)
    return d

def checkmin(n1, n2, n3):
    return min(n1, n2, n3)
    
if len(sys.argv) != 2:
    print("Usage: factors <file>")
    sys.exit(1)
try:
    with open(sys.argv[1], 'r') as file:
        for line in file:
            number = int(line)
            n1, n2, n3 = number, 0, number
            check = 0
            for i in range(2, int(sqrt(sqrt(number))) + 1):
                if number % i == 0:
                    #print("{}={}*{}".format(int(number), int(number//i), int(i)))
                    n1 = i
                    break
            for i in range(number - 1, int(number - int(sqrt(sqrt(number)))) + 1, -1):
                    if number % i == 0:
                        #print("{}={}*{}".format(int(number),int(i), int(number//i)))
                        n2 = i
                        break
            n3 = rho_fun(number)
            if n3 == 0:
                n3 = number
            n = checkmin(n1, number - n2, n3)
            if n > number // n:
                print("{}={}*{}".format(int(number),int(n), int(number//n)))
            else:
                print("{}={}*{}".format(int(number), int(number//n), int(n)))
            #print("{}={}*{}".format(number, number // rho_fun(number), rho_fun(number)))
except IOError:
    print("Can't read the file")
    sys.exit(1)
